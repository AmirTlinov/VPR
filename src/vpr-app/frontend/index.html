<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Silentway</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="app">
    <!-- Header -->
    <header class="header">
      <div class="logo">Silentway</div>
      <div class="custom-dropdown" id="server-dropdown">
        <button class="dropdown-trigger" id="dropdown-trigger">
          <span class="dropdown-value" id="dropdown-value">+ Add server</span>
          <svg class="dropdown-arrow" width="12" height="12" viewBox="0 0 16 16" fill="currentColor">
            <path d="M8 11L3 6h10l-5 5z"/>
          </svg>
        </button>
        <div class="dropdown-menu" id="dropdown-menu">
          <div class="dropdown-item" data-value="new">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="12" y1="5" x2="12" y2="19"></line>
              <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
            <span>Add server</span>
          </div>
        </div>
        <!-- Hidden select for form compatibility -->
        <select id="header-server-select" class="hidden">
          <option value="new">+ Add server</option>
        </select>
      </div>
      <button class="icon-btn" id="settings-btn" title="Advanced Settings">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="1"></circle>
          <circle cx="19" cy="12" r="1"></circle>
          <circle cx="5" cy="12" r="1"></circle>
        </svg>
      </button>
    </header>

    <!-- Main View -->
    <main class="main" id="main-view">
      <!-- Globe Card - Premium Centerpiece (hidden initially until servers loaded) -->
      <div class="globe-card hide-globe" id="globe-card">
        <div id="globe-container">
          <!-- Canvas Particle Globe -->
        </div>
        <div class="status-info">
          <div class="status-label" id="status-label">Not Connected</div>
          <div class="status-details" id="status-details">Enter your server details below</div>
        </div>
      </div>

      <!-- Legacy Status Card (hidden, for fallback) -->
      <div class="status-card hidden">
        <div class="status-icon" id="status-icon">
          <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
          </svg>
        </div>
      </div>

      <!-- Server Setup (shown only when adding new server) -->
      <div class="setup-card hidden" id="setup-card">
        <!-- Hidden legacy server selector (logic still used) -->
        <select id="server-select" class="hidden">
          <option value="new">+ Add new server...</option>
        </select>

        <!-- Server form header with delete button -->
        <div class="setup-header" id="setup-header">
          <div class="setup-header-text">
            <span class="setup-title" id="setup-title">Configure Server</span>
            <span class="setup-subtitle" id="setup-subtitle">We'll automatically set up VPN on your server</span>
          </div>
          <button class="icon-btn delete-server-btn hidden" id="delete-server-btn" title="Delete server">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="3 6 5 6 21 6"></polyline>
              <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
            </svg>
          </button>
        </div>

        <!-- Server form -->
        <div id="new-server-form">
          <div class="input-group">
            <label>Server Address</label>
            <input type="text" id="server-input" placeholder="your-server.com or IP address" spellcheck="false" autocomplete="off">
          </div>
          <div id="ssh-fields">
            <div class="input-row">
              <div class="input-group" style="flex:2">
                <label>Username</label>
                <input type="text" id="user-input" placeholder="root" spellcheck="false" autocomplete="off">
              </div>
              <div class="input-group" style="flex:1">
                <label>SSH Port</label>
                <input type="text" id="port-input" placeholder="22" spellcheck="false">
              </div>
            </div>
            <div class="input-group">
              <label>Password</label>
              <input type="password" id="pass-input" placeholder="SSH password (first time only)">
            </div>
          </div>
        </div>
      </div>

      <!-- Stats Panel (expandable to show logs) -->
      <div class="stats-panel hidden" id="stats-card">
        <div class="stats-header" id="stats-header">
          <div class="stat-item">
            <span class="stat-value" id="stat-time">00:00:00</span>
            <span class="stat-label">Duration</span>
          </div>
          <div class="stat-divider"></div>
          <div class="stat-item">
            <span class="stat-value" id="stat-up">0 B</span>
            <span class="stat-label">Upload</span>
          </div>
          <div class="stat-divider"></div>
          <div class="stat-item">
            <span class="stat-value" id="stat-down">0 B</span>
            <span class="stat-label">Download</span>
          </div>
          <div class="stat-divider"></div>
          <button class="log-toggle-btn" id="log-toggle-btn" title="Toggle log">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
              <polyline points="14 2 14 8 20 8"></polyline>
              <line x1="16" y1="13" x2="8" y2="13"></line>
              <line x1="16" y1="17" x2="8" y2="17"></line>
            </svg>
          </button>
        </div>
        <div class="stats-log-area" id="log-card">
          <div class="log-area" id="connection-log"></div>
        </div>
      </div>

      <!-- Progress (shown during setup) -->
      <div class="progress-card hidden" id="progress-card">
        <div class="progress-bar">
          <div class="progress-fill" id="progress-fill"></div>
        </div>
        <div class="progress-text" id="progress-text">Preparing...</div>
        <div class="log-area" id="log-area"></div>
      </div>

      <!-- Main Action Button -->
      <button class="main-btn" id="main-btn">
        <span class="btn-text" id="btn-text">Connect</span>
        <span class="btn-loader hidden" id="btn-loader"></span>
      </button>

      <!-- Error Display -->
      <div class="error-box hidden" id="error-box">
        <span class="error-text" id="error-text"></span>
        <button class="error-close" id="error-close">Ã—</button>
      </div>
    </main>

    <!-- Advanced Settings (hidden by default) -->
    <main class="main hidden" id="settings-view">
      <div class="settings-header">
        <button class="back-btn" id="back-btn" title="Back">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
          </svg>
        </button>
        <span class="settings-page-title">Settings</span>
      </div>
      <div class="settings-card">
        <div class="settings-section">
          <div class="settings-title">Security</div>
          <label class="toggle-row">
            <span>Kill Switch</span>
            <input type="checkbox" id="cfg-killswitch">
            <span class="toggle"></span>
          </label>
          <label class="toggle-row">
            <span>Auto-connect on startup</span>
            <input type="checkbox" id="cfg-autoconnect">
            <span class="toggle"></span>
          </label>
          <label class="toggle-row warn">
            <span>Skip TLS verification</span>
            <input type="checkbox" id="cfg-insecure">
            <span class="toggle"></span>
          </label>
        </div>

        <div class="settings-section">
          <div class="settings-title">Advanced</div>
          <div class="input-group small">
            <label>VPN Port</label>
            <input type="text" id="cfg-vpn-port" placeholder="4433" spellcheck="false">
          </div>
          <div class="input-group small">
            <label>Protocol</label>
            <select id="cfg-mode">
              <option value="masque">MASQUE (HTTP/3)</option>
              <option value="quic">QUIC</option>
            </select>
          </div>
        </div>

        <div class="settings-section danger-zone">
          <div class="settings-title">Server Management</div>
          <button class="danger-btn" id="reinstall-btn">Reinstall Server</button>
          <button class="danger-btn" id="uninstall-btn">Remove from VPS</button>
        </div>
      </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
      <span class="version">Silentway v0.1.0</span>
    </footer>
  </div>

  <!-- Canvas Particle Globe + App -->
  <script src="globe.js"></script>
  <script src="app.js"></script>
</body>
</html>
